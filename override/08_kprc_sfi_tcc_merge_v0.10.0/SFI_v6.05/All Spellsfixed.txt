
Various spell, bard songs, and invocation fixes for NWN2, MoTB and SoZ.

Spells that were just fixed (no balancing done to the scripts or not brought into line with PnP) are in the "Spellsfixed" folder.

Spells that were just fixed (no balancing done to the scripts but are already in-line with PnP) are in the "SpellsfixedPnP" folder.

The "Spellsimproved" folder contains spells that are tweaked a little, such as the summons spells having longer durations.

"SpellsPnP" contains spells that were either improved to use their PnP stats or were fixed because they were broken, and in the process, I fixed them to use their PnP stats.

"3.5 Classes" contains custom class changes to bring them more in-line with PnP.


Download and unzip (I used WinRAR) the archive. Put unzipped files and folders from archive into your MyDocuments/Override folder.


"Spellsfixed":

Fixed giving sneak attacks with eldritch cone and chain since it shouldn't.

-Avasculate- Ray effect gets shown every time now. Now tells you if the target is immune to death magic.
-Barbarian Rage- Recompiled so Heal, Mass Heal, Lesser Restoration, Restoration, and Greater Restoration can now remove fatigue effects.
-Blade Barrier self- Linked effects so dispel magic, cast on caster, removes all effects.
-Bull's Strength- Now stacks properly with Righteous Might. Can't stack this spell with Mass Bull's Strength. Now checks for Blackguard levels. Now stacks with Enlarge Person or Duergar Enlarge Racial ability.
-Burst of Glacial Wrath- Fixed problem with allowing immortality flag to be on creature(s) for too long. Creatures encased in ice now get proper Damage Reduction effect (DR 10/-). Won't accidentally affect caster anymore. Nobody gets skipped in the cone's area of effect anymore. Creatures with Cold Vulnerability won't be killed by this spell anymore. Feedback is displayed if creature is frozen solid.
-Cacophonic Burst- Each target rolls for damage individually now. Used to roll once and apply same damage to every target.
-Devour Magic- Will no longer stack temporary hitpoints.
-Displacement- Can now be persisted (24 hour duration).
-Eldritch Blast- Now respects immunity to criticals. Fixed visual so that ray effect gets shown even for missed or resisted targets.
-Eldritch Chain- Can be modified by PointBlankShot feat.
-Eldritch Essences- If target is affected by an essence and then saves versus same essence again, first affect is not removed anymore. Only removed if 2nd save is failed since a new effect is going to be added and they can't stack anymore.
-Energy Drain- Added sneak attack damage. Now uses ranged touch attack. Doesn't have a saving throw anymore since it uses a ranged touch attack. Correctly calculates extra damage on critical hit. Respects immunity to critical hits. This brings it inline with Enervation.
-Entropic Husk- Duergar won't increase in size again if already affected by their racial Enlarge Person ability. Having Mind Spell Immunity doesn't protect from the insanity effect.
-Ghast Stench Aura- Added immunity to poison check to prevent effects being applied if immune.
-Greater Spell Mantle- Now works correctly with AOEs that have a duration (Wall of Fire for example). All AOEs with a duration will have to be redone to accomodate the changes.
-Hezrou Stench Aura- Added immunity to poison check to prevent effects being applied if immune.
-Infestation of Maggots- Immunity to Disease now works correctly.
-Inflict Wounds line of spells- Now takes into account Melee Spell Specialization. Now takes into account Weapon Finesse.
-Inflict Wounds line of Spells- Added sneak attack damage. Now do critical hits for extra damage. Respects immunity to criticals. No attack roll versus undead, since it's assumed you are trying to heal them and they are immune to criticals.
-Invocation: Flee the Scene- Expeditious Retreat should have a 50% movement speed increase which would equal a total movement speed of 150%. Should not be a 150% increase in speed. Haste effect should apply to caster and his allies, not just his allies. Delayed the Expeditious Retreat effect being applied. Won't take affect during the first 5 rounds as this would super-stack it with Haste.
-Invocation: Flee the Scene- Won't stack with itself anymore. Removed +2 AC bonus as it should not be part of the spell (It's not in Expeditious Retreat).
-Invocation: Hideous Blow- Can be cast in advance without the need to target an enemy.
-Iron Body- Fixed a bug so that Stormlords (9th level or higher) no longer lose their immunity to electricity. Fixed a bug so that Red Dragon Disciples (10th level) no longer lose their immunity to fire.
-Isaac's Lesser Missile Storm- Won't strip off Spell Mantles anymore.
-Isaac's Greater Missile Storm- Won't strip off Spell Mantles anymore.
-Jagged Tooth- Now actually works.
-Least Spell Mantle- Now works correctly with AOEs that have a duration (Wall of Fire for example). All AOEs with a duration will have to be redone to accomodate the changes.
-Lesser Spell Mantle- Now works correctly with AOEs that have a duration (Wall of Fire for example). All AOEs with a duration will have to be redone to accomodate the changes.
-Magic Circle Against Good/Evil- Now works on allies.
-Mass Aid- Fixed issue with temporary hitpoints inadvertently being removed from the caster. Removed Spell Resistance check. De-linked HP from other effects so entire spell isn't cancelled when losing bonus hitpoints. Can't stack this spell with itself or regular version of Aid anymore. Used removeTempHitpoints() call so it REALLY doesn't stack with anything.
-Mass Bear's Endurance- Won't stack with Bear's Endurance or Mass Bear's Endurance anymore.
-Mass Bull's Strength- Can't stack this spell with Bull's Strength anymore.
-Mass Charm Monster- Can now be scribed on scrolls.
-Mass Cure Line of Spells (not including Mass Cure Light Wounds)- Now takes into account Augmented Healing Feat. Uses will save now instead of incorrect fortitude save. Was using wrong variable during metmagic mods. Won't automatically hurt friendly undead anymore, only if they are in the area of effect.
-Mass Cure Serious Wounds- Corrected heal amount to 3d8 (not 4d8) +1 per caster level.
-Polar Ray- Now takes into account Ranged Spell Specialization. Now takes into account Point Blank Shot. Added sneak attack damage. Correctly calculates extra damage on critical hit. Respects immunity to critical hits.
-Reach to the Blaze- Removed damage from on-enter script, as this could be abused for hundreds of hitpoints of damage per round. Damage is calculated for each target seperately now. Previously, the script was calculating damage once, then applying it to all targets.
-Searing Light- Now takes into account Ranged Spell Specialization. Now takes into account Point Blank Shot. Added sneak attack damage. Correctly calculates extra damage on critical hit. Respects immunity to critical hits.
-Shadow Dancer's Shadow Evade- Now the Damage Reduction will actually do something. Also, it's a Dodge Bonus to AC not a regular Armor Bonus to AC. Some cases were left blank. That would mean no effect would occur at that level. Now fixed.
-Shocking Grasp- Now takes into account Melee Spell Specialization. Now takes into account Weapon Finesse. Added sneak attack damage. Correctly calculates extra damage on critical hit. Respects immunity to critical hits.
-Slay Living- Now takes into account Melee Spell Specialization. Now takes into account Weapon Finesse. Added sneak attack damage. Correctly calculates extra damage on critical hit. Respects immunity to critical hits.
-Song of Heroism- No longer removes inspirations when used. Depleting temporary hitpoints doesn't end other effects of this song anymore.
-Spell Mantle- Now works correctly with AOEs that have a duration (Wall of Fire for example). All AOEs with a duration will have to be redone to accomodate the changes.
-Stone Body- Fixed a bug so that Stormlords (9th level or higher) no longer lose their immunity to electricity. Fixed a bug so that Red Dragon Disciples (10th level) no longer lose their immunity to fire.
-Storm Avatar- Now does 3d6 electrical damage. Applies electrical bonus to weapon even if it has other elemental enchantments already. Fixed movement speed increase. According to the description, you travel at 200% normal speed (twice as fast). +200% normal speed would be three times as fast. So lowered to doubled speed instead of tripled speed. Fixed metamagic duration for extended spell.
-Storm of Vengeance- Can't stack spell anymore. Caster Level stored on AOE for proper Dispel Magic callback.
-Storm of Vengeance- Was using wrong duration for stun effect. Should be 1 round, not 2 rounds, as per the in-game description. Lowered electrical damage to 3d6, on a failed save, not the incorrect 6d6 that it was using.
-Storm of Vengeance- Will now cancel the area of effect if the creator of the effect is dead. Applies random damage rolls to each target, not one roll per round applied to every target.
-Swamp Lung- Can't stack this spell on an already affected target. If you try, you will be given a message stating that.
-Tenacious Plague- Stopped this spell from stacking as per the in-script description. Now auto-hits on a 20 and auto-misses on a 1. Will correctly be dispelled now by Gust of Wind or Dispel Magic. Fixed the fact that the duration was being calculated incorrectly for metamagic Extend.
-Tortoise Shell- Now properly capped at +9 AC max.
-Touch of Fatigue- Recompiled so Heal, Mass Heal, Lesser Restoration, Restoration, and Greater Restoration can now remove fatigue effects.
-Vampiric Touch- Now takes into account Weapon Finesse. Now takes into account Melee Spell Specialization. Added sneak attack damage. Uses correct calculation for maximized damage. Added critical hit check. Correctly calculates extra damage on critical hit. Heals extra damage on critical. Respects immunity to criticals.
-Warlock Invocations- PointBlankShot feat check added. If present, ranged touch attack is modified by +1 (if you are 30 feet or closer to your target). Added sneak attack damage. Eldritch Blasts can now do critical hit for extra damage. Can't stack most blasts anymore.


"SpellsfixedPnP":

-Aid- Reworked script so RemoveTempHitPoints call works correctly. Won't stack with Mass Aid anymore. Uses RemoveTempHitpoints() call so it REALLY doesn't stack with anything anymore. Won't stack with itself anymore.
-Assay Resistance- Gives correct 1 round/level duration. Correctly applies +10 Spell Penetration Bonus to Caster instead of Target. EventSpellCastAt is now using correct Spell_Target_StandardHostile.
-Augmented Healing Feat- Will no longer add bonus to any scrolls, potions, or healing items.
-Bear's Endurance- Won't stack with Mass Bear's Endurance anymore. Can't be stacked at all anymore. If you try, it will give a message that you can't stack Bear's Endurance and then it will abort the rest of the spell.
-Body of the Sun- Can now be selected by Wizards and Sorcerers.
-Confusion- Fixed so metamagic extend actually works now.
-Cure Spells- Changed maximized healing to work correctly. Was using wrong calculation.
-Enlarge Person- Now stacks properly with Bull's Strength. Can now be cast on Githyanki and Githzerai. Won't stack with Duergar spell-ability Enlarge or other size increasing spells.
-Enlarge Person (Duergar Racial Ability)- Now stacks properly with Bull's Strength. Won't stack with Enlarge Person or other size increasing spells.
-FlameStrike- Now only does one save, instead of incorrectly doing two saves. Save type is versus spells, not divine or fire. Immunity to either shouldn't matter for the save. When the damage is applied, immunity will correctly block the appropriate damage.
-Magic Weapon: Enhancement bonuses are allowed on Ranged Weapons, so this spell should work on them too. Monks can take advantage of this spell (if wearing Gauntlets), as well as anyone wearing Gauntlets.
-Polymorph Self- Updated for Succubus Polymorph ability. Removed feedback from spell. Now heals the recipient of physical damage, when initially polymorphing, as per PnP. Now you don't lose your bonus spell-slots if they are a result of an ability-increasing item.
-Scorching Ray (both versions)- Now respects immunity to criticals. Single target version now shows ray effect every single time (even if resisted or it misses). Multiple target version now correctly calculates number of hostiles in area on Hardcore difficulty or higher. Both versions can now do sneak attack damage. Both versions can be used with the Ranged Spell Specialization feat.
-Sleep- Now properly removes caster's invisibility when cast.
-Vitriolic Sphere- Ignores Spell Resistance. Metamagic variable properly stored for future callbacks so casting another metamagically enhanced spell will not apply new metamagic to this spell. Correctly applies full damage in 1st round no matter what. Made save means no further damage. Failed save in round 1 means further damage in round 2. Made save in round 2 results in 1/2 damage (or less- takes into account Evasion and Improved Evasion) and no further damage. Failed save in round 2 results in damage (Takes into account Improved Evasion) and a 3rd round of possible damage. Round 3 takes into account Evasion and Improved Evasion.



"Spellsimproved":

-Animate Dead- Now you can have multiple summons. Skeleton Warrior now gets bonus of 1d8 cold damage if above caster level 14. Skeleton Warrior's attack bonus scales with you at a one to one ratio with your caster level, if above caster level 14. This helps to keep the spell useful at higher levels. This spell also works with the "Summon Creature" line of spells, Create Undead, Create Greater Undead and the Planar Binding line of spells. You can now control the rate at which the undead's Level and AC scales with you. AB still scales at 1/2 your level as the summon is way too powerful if allowed to scale at a higher rate. Level cappped at 30 as the game engine won't allow more than 30 levels. AB increase will stack with other AB increasing spells. Natural AC bonus changed to Shield AC Bonus (like shield spell) so you can still use natural AC enhancing spells to increase the summon's AC. Can no longer target a creature when casting this spell (prevents a bug where undead wouldn't scale with caster-level).
-Archer's belt- Fixed blueprint so Damage Reduction works correctly.
-Belt of Inertial Barrier- Fixed blueprint so Damage Reduction works correctly.
-Bone Dancer Ring (MoTB)- Fixed blueprint so Damage Reduction works correctly.
-Brawler's belt- Fixed blueprint so Damage Reduction works correctly.
-Create Undead- Now you can have multiple summons. Epic Mummy Lord now has regeneration ability of 4 hp/round. Epic Mummy Lord now gets a bonus of 1d8 Negative Energy damage to it's attacks. This spell also works with the "Summon Creature" line of spells, Animate Dead, Create Greater Undead and the Planar Binding line of spells. Summons a Mummy (11th-15th level caster), Lesser Mummy Lord (16th level caster or higher who is not an epic character yet) or an improved MummyLord (Epic level caster). You can now control the rate at which the undead's Level and AC scales with you. AB still scales at 1/2 your level as the summon is way too powerful if allowed to scale at a higher rate. Level cappped at 30 as the game engine won't allow more than 30 levels. AB increase will stack with other AB increasing spells. Natural AC bonus changed to Shield AC Bonus (like shield spell) so you can still use natural AC enhancing spells to increase the summon's AC. Can no longer target a creature when casting this spell (prevents a bug where undead wouldn't scale with caster-level).
-Create Greater Undead- Now you can have multiple summons. Vampires now do 3 hitpoints of bonus negative energy damage per hit instead of cold damage. Epic Level characters now summon a Night Walker if their caster level is greater than 20. This spell also works with the "Summon Creature" line of spells, Animate Dead, Create Undead and the Planar Binding line of spells. Creatures summoned are now Skeleton Warrior, Dread Wraith, Vampire (Fighter 11), Elite Vampire (Fighter 6/ Cleric 9), and Night Walker. Can no longer target a creature when casting this spell (prevents a bug where undead wouldn't scale with caster-level). You can now control the rate at which the undead's Level and AC scales with you. AB still scales at 1/2 your level as the summon is way too powerful if allowed to scale at a higher rate. Level cappped at 30 as the game engine won't allow more than 30 levels. AB increase will stack with other AB increasing spells. Natural AC bonus changed to Shield AC Bonus (like shield spell) so you can still use natural AC enhancing spells to increase the summon's AC.
-Creature slam attack (Mummy)- Wasn't doing enough damage. Damage was increased from 1d6+7 to PnP correct 1d6+10.
-Elemental Summoning items- Fixed to allow multiple summons (Bowl of Commanding Water Elementals, Brazier of Commanding Fire Elementals, Censer of Controlling Air Elementals, and Stone of Controlling Earth Elemetals). Summon gets an automatic +5 to AC if user of summoning pool is above level 14. This helps to keep the spell useful at higher levels. This spell also works with Animate Dead, Create Undead, Create Greater Undead and the Planar Binding line of spells. Now actually work correctly. Fixed the fact that the summon elemental items always summoned an Air elemental. You can now control the rate at which the elemental's Level and AC scales with you. AB still scales at 1/2 your level as the summon is way too powerful if allowed to scale at a higher rate. Level cappped at 30 as the game engine won't allow more than 30 levels. AB increase will stack with other AB increasing spells. Natural AC bonus changed to Shield AC Bonus (like shield spell) so you can still use Natural AC enhancing spells to increase the summon's AC.
-Flame Arrow- In-game description updated to properly state that no save is allowed. Range changed from Long to Medium. Added sneak attack damage (on first arrow only). Corrected damage to 4d6 per arrow not 4d6+1 per arrow. Removed spell resistance check since it's a conjuration spell. Now correctly calculates extra damage on critical hit. Respects immunity to criticals.
-Greater Archer's belt- Fixed blueprint so Damage Reduction works correctly.
-Greater Brawler's belt- Fixed blueprint so Damage Reduction works correctly.
-Greater Planar Binding- Now you can have multiple summons. This spell also works with the "Summon Creature" line of spells, Animate Dead, Create Undead and Create Greater Undead. You can now control the rate at which the summon's Level and AC scales with you. AB still scales at 1/2 your level as the summon is way too powerful if allowed to scale at a higher rate. Level cappped at 30 as the game engine won't allow more than 30 levels. AB increase will stack with other AB increasing spells. Natural AC bonus changed to Shield AC Bonus (like shield spell) so you can still use natural AC enhancing spells to increase the summon's AC. Summon's attack bonus scales with you at 3/4 your caster level, if above caster level 14. Summon gets an automatic +5 to AC if above caster level 14. This helps to keep the spell useful at higher levels.
-Greater Swordsman's belt- Fixed blueprint so Damage Reduction works correctly.
-Invocation: The Dead Walk- Summon's attack bonus scales with you at a rate of 1/2 your caster level. Skeleton Warrior's attack bonus scales with you at 3/4 your caster level, if above caster level 14. Skeleton Warrior now gets bonus damage of 1d8 cold damage if above caster level 14. This helps to keep the invocation useful at higher levels. You can now control the rate at which the summon's Level and AC scales with you. AB increase will stack with other AB increasing spells. Natural AC bonus changed to Shield AC Bonus (like shield spell) so you can still use Natural AC enhancing spells to increase the summon's AC. Now can summon multiple undead when using this invocation multiple times. Lowered duration to 1 minute per level to follow PnP. Can only have a total number of undead whose hitdice is equal to, or less than, 4 times the Warlock's level (as per PnP).
-Iron Skin Ring- Fixed blueprint so Damage Reduction works correctly.
-Lesser Planar Binding- Now you can have multiple summons. You can now control the rate at which the summon's Level and AC scales with you. AB still scales at 1/2 your level as the summon is way too powerful if allowed to scale at a higher rate. Level cappped at 30 as the game engine won't allow more than 30 levels. AB increase will stack with other AB increasing spells. Natural AC bonus changed to Shield AC Bonus (like shield spell) so you can still use Natural AC enhancing spells to increase the summon's AC.
-Negative Energy Burst- Spell was enabled. Can use scribe scroll to create copies to give to other spell-casters. Scroll is NW_IT_SPARSCR3111. Uses same effects as NWN HotU (1d8 +1 damage/level and 1 point of strength-damage per 4 levels. Opposite effects to undead). Capped at 20 levels. Added a visual effect for the strength-drain that gets applied to non-undead.
-Negative Energy Burst- Default level of scrolls upped from level 5 to level 10. Corrected scripting error where Undead would make a save and get healed for only half the amount. Targets now take damage immediately instead of having a small delay before the spell affects them.
-Palemaster's Summon Greater Undead- Now you can have multiple summons. Vampires now do 3 hitpoints of bonus negative energy damage per hit instead of cold damage. Epic Level characters now summon a Night Walker if their caster level is greater than 20. This spell also works with the "Summon Creature" line of spells, Animate Dead, Create Undead and the Planar Binding line of spells. Creatures summoned are Vampire (Fighter 11), Elite Vampire (Fighter 6/ Cleric 9), and Night Walker. You can now control the rate at which the undead's Level and AC scales with you. AB still scales at 1/2 your level as the summon is way too powerful if allowed to scale at a higher rate. Level cappped at 30 as the game engine won't allow more than 30 levels. AB increase will stack with other AB increasing spells. Natural AC bonus changed to Shield AC Bonus (like shield spell) so you can still use natural AC enhancing spells to increase the summon's AC.
-Planar Binding- Now you can have multiple summons. Spell resistance of Celestial Bear now scales with caster at value of HD + 5. This spell also works with the "Summon Creature" line of spells, Animate Dead, Create Undead and Create Greater Undead. You can now control the rate at which the summon's Level and AC scales with you. AB still scales at 1/2 your level as the summon is way too powerful if allowed to scale at a higher rate. Level cappped at 30 as the game engine won't allow more than 30 levels. AB increase will stack with other AB increasing spells. Natural AC bonus changed to Shield AC Bonus (like shield spell) so you can still use natural AC enhancing spells to increase the summon's AC.
-Resist Energy- Now lasts 24 hours just like the other resistance versus elemental damage spells.
-Silence- Friendly targets don't require a Spell-resistance check or a saving throw anymore.
-Silence (on-enter)- Increased duration to take into account epic levels and Practiced Spellcaster.
-Silence (on-exit)- Now takes into account spell-radial versions.
-Summon Creature line of spells- There is no longer a limit on how many summons you can have with this spell. However, there is a limit of one per casting. Duration was changed to 2 rounds per level. Summon gets an automatic +5 to AC if caster level is above level 14. This helps to keep the spell useful at higher levels. This spell also works with Animate Dead, Create Undead, Create Greater Undead and the Planar Binding line of spells. You can now control the rate at which the summon's Level and AC scales with you. AB still scales at 1/2 your level as the summon is way too powerful if allowed to scale at a higher rate. Level cappped at 30 as the game engine won't allow more than 30 levels. AB increase will stack with other AB increasing spells. Natural AC bonus changed to Shield AC Bonus (like shield spell) so you can still use natural AC enhancing spells to increase the summon's AC.
-Summoned Succubus- Creature blueprint updated (Planar Binding spell) to more closely resemble PnP. Now has unlimited Ethereal Jaunt and Poymorph self (will only choose humanoid forms so no Umber Hulk or Sword Spider). Removed the following spell abilities: Darkness, Clairaudience and Doom. Now is correctly classified as a female.
-Summoned Sylph- Creature blueprint updated in Planar Binding spell. Base level Sylph is a 7th level Sorcerer. The Slyph's Sorcerer level will scale with your caster level.
-Swordsman's belt- Fixed blueprint so Damage Reduction works correctly.




"SpellsPnP":

Fixed giving sneak attacks with eldritch doom since it shouldn't.

-Acid Fog- No spell resistance. Increased duration to last 1 round/level as per PnP. Removed spell save as per PnP there isn't one. Lowered initial damage to 2d6 as per PnP. Correctly calculates random damage for each target in the area of effect rather than one roll per round applied to every target. Will now remove Area of Effect if caster is dead. 
-Acid Fog- Lowers movement speed to 5 feet per round. Gives affected targets -2 to attacks and damage inflicted. Can't be hit by ranged weapons nor can you hit with ranged weapons while in the fog cloud as per PnP. Gives 20% concealment to affected targets versus melee attacks while in the fog cloud.
-Acid Fog- Changed Range from Long to Medium as Per PnP. Changed radius size from 15' to 20' as per PnP. Changed TargetingUI (3rd column from end) from 8 to 2 to match 20' radius.
-Acid Fog- Caster Level stored on AOE for proper Dispel Magic callback. This is the second AOE that works using my Dispel Magic code for removing AOE's. Can't stack spell in the same area of effect anymore. This is the second AOE that works this way.
-Acid Fog (On Exit Script): Now properly removes any/all of the negative effects.
-Acid Splash- Now takes into account Point Blank Shot. Now takes into account Ranged Spell Specialization. Range changed from Medium to Short. Added sneak attack damage. Removed spell resistance check. Added critical hit for extra damage. Respects immunity to critical hits.
-Aura of Glory- Removed feedback so it won't display what loops are being used to remove effects. Changed radius size from Colossal to Medium (10' radius) to match PnP. Now is instant duration and removes fear effects (on Paladin's allies) as per PnP. Fear effects include shaken effects. Won't stack any effects anymore. Removed the following part of the script as it isn't PnP: Paladin gets +4 to Charisma. Allies get +5 to saves versus fear.
-Aura of Vitality- Changed radius size from Colossal to Large (15' radius) to match PnP. Maximum number of allies affected is equal to CasterLevel/3 as per PnP. Range changed from Touch to Short. Won't stack with itself anymore.
-Balagarn's Iron Horn- Changed school from Enchantment to Transmutation.
-Bane- Changed TargetType (column 9) from 0x29 to 0x2D. Only way to make it work correctly. Still casts centered on caster no matter where you actually target it on the ground, but since the range is still set as "Personal", it is HIGHLY recommended that you target the ground right next to yourself (otherwise you will run to the spot where the spell target was to cast the spell). Changed radius size from 30' to 50' as per PnP. Now casts centered on caster as per PnP. Correctly set duration to 1 turn per level.
-Banishment- Changed radius size from 30' to 15' as per PnP. Changed TargetingUi to show 15' radius. Now affects targeted area properly, instead of just area around the caster.
-Barkskin- Now follows PnP stats. Base AC of 2. Increases by +1 for every 3 levels above 3rd level. Max of +5 at 12th level. Sets duration (1.5 min/level) to mid-way between 1 min/level and 1 hour/level since 2 real minutes = 1 game hour. 10 min/level spell should be more than 1 min/level spell but not quite 1 hour/level spell.
-Battle Tide- Spell saving throw was being calculated wrong. Dispel Magic shouldn't dispel the effect anymore, while in the area of effect, since I changed it to an Extraordinary effect (Not a magical effect so Dispel Magic shouldn't work). This is per NWN2Wiki. 
-Battle Tide- Range changed from Personal to Short. Changed Area of Effect to a 15' radius. Changed TargetingUI to reflect 15' radius. Linked haste with Area of effect so they are both dispelled properly. Can't be stacked anymore.
-Bestow Curse- Now saves caster level on target so Greater Dispel works correctly. Skill decrease parameter values were backwards. Now corrected (actually gives -4 to skills now). Changed from Transmutation to Necromancy as per PnP. Afflicted creature must save or suffer a -4 penalty on to-hit rolls, saves, and skill checks. This is a supernatural effect. This follows the PnP description.
-Bigby's Clenched Fist- Range changed from Long to Medium. Metamagic variable properly stored for future callbacks. Now does magical damage, not plain bludgeoning damage. Checks to see if the target is under the effects of another Bigby's spell. If it is, this spell will not have an effect. 
-Bigby's Crushing Hand- Freedom of Movement now makes you immune to this spell. Range changed from Long to Medium. Metamagic variable properly stored for future callbacks. Now does magical damage, not plain bludgeoning damage. Checks to see if the target is under the effects of another Bigby's spell. If it is, this spell will not have an effect. Can't grapple a creature who is bigger than HUGE. But it can still damage it. Modified to better simulate a touch attack on the grapple to hit roll. Removes armor bonus from chest slot, armor bonus from bracers or gauntlets, natural armor bonus from amulets, shield bonus from an equipped shield, and armor bonus from belts. By doing this it more closely simulates a melee touch attack which doesn't allow you your armor bonus, natural armor bonus, or shield bonus.
-Bigby's Forceful Hand- Range changed from Long to Medium. Checks to see if the target is under the effects of another Bigby's spell. If it is, this spell will not have an effect. Used Immobilize (to simulate being stopped by a Bullrush) attempted once per round rather than one knockdown attempt that lasts the entire duration.
-Bigby's Grasping Hand- Freedom of Movement now makes you immune to this spell. Range changed from Long to Medium. Metamagic variable properly stored for future callbacks. Checks to see if the target is under the effects of another Bigby's spell. If it is, this spell will not have an effect. Makes a grapple check. If succesful target is held immobile for 1 round/level. Can't affect a creature who is bigger than HUGE. Modified to better simulate a touch attack on the grapple to hit roll. Removes armor bonus from chest slot, armor bonus from bracers or gauntlets, natural armor bonus from amulets, shield bonus from an equipped shield, and armor bonus from belts. By doing this it more closely simulates a melee touch attack which doesn't allow you your armor bonus, natural armor bonus, or shield bonus.
-Bigby's Interposing Hand- Now slows down target as per PnP. Can't slow down creatures weighing more than 2000 pounds (Huge creatures). Obviously, this is an approximation. Prevents stacking of this spell with other Bigby's spells.
-Blast of Flame- New spell. Redid scroll so it actually works again. Can use scribe scroll to create copies to give to other spell-casters. Scroll is NW_IT_SPARSCR4111. No longer damages caster by mistake.
-Bless- In-game description now matches spell. Changed radius size from 30' to 50' as per PnP. Now casts centered on caster as per PnP (changed from Long to Personal). Corrected duration to 1 minute/level. 
-Blindness/Deafness- Now follows PnP: 50% movement speed decrease, -4 to search checks, and automatically fail spot checks (simulated by giving a -50 penalty to spot skill). Target loses Dexterity bonus (only applies if Dexterity is above 10). Removed somatic component from spell (in Spells.2da) as per PnP. Changed to Supernatural effect and made duration permanent as per PnP.
-Bombardment- Changed radius size to 15' radius (Large) as per PnP. Increased max damage to 20d8 and removed spell resistance as per PnP. No longer applies knockdown, but rather CutSceneImmobilize. This simulates being buried (if you fail your save). Every round you do a DC20 strength check. If failed, you are still buried (try again in 6 seconds). If you succeed, you are free and can act normally. While buried: You are immune to everything. All effects are applied as "Supernatural" so resting and Dispel Magic can't remove them. All effects wear off after one minute max so players on PW's aren't stuck for insanely long times if they have low strength. It's still supposed to be a fun game; one minute is long enough. Changed save type to SPELL so your ranks in Spellcraft are taken into account.
-Breath weapon of Dragon Companion- Each target now has damage calculated individually. Now uses PnP correct DC calculation for breath weapon. Lightning breath weapon now shows visual effect. Size of breath weapon is based on the age and color of the dragon. Shape of breath weapon is based on dragon color. Red and Green use a cone, while Blue uses a cylinder (line).
-Burning Hands- In-game description now matches spell.
-Cause Fear- On successful will save, if creature has less than 6HD, it is still shaken for 1 round as per PnP. Shaken = -2 to Saves, Attack rolls, and Damage rolls. 
-Cause Fear- Fixed "Shaken" penalties as follows: Changed Damage decrease to Skill decrease (should never have been a damage penalty but rather a skill penalty). Also, changed saving throw decrease from will saves versus mind spells to all saves versus all types of spells as per PnP.
-Celestial Bear (Planar Binding spell)- Creature hide updated to more closely resemble PnP. Damage resistances (acid, cold and electricity) increased from 5/- to 10/- . Spell resistance increased to 14 as their SR should be HD +5 (8+5=13 but 13 is not an option so went to next higher value of 14). SR scales with their level (HD + 5) when summoned as summoned creature scales with your caster level.
-Charm Animal- Reworked script so charm isn't permanent anymore. Now actually increases saving throw of target creature, rather than lowering Save DC. Have to cap at 41 hours max or the Charm effect is permanent (except with Dispel Magic). Now uses correct PnP duration of 1 hour per level. Target gets +5 to save attempt if in combat (as per PnP). If Target fails an opposed Charisma check, it is Dominated instead of Charmed. This simulates the caster being able to convince the Target to do something it wouldn’t ordinarily do. (Retries are not allowed.)
-Charm Monster- Reworked script so charm isn't permanent anymore. Now actually increases saving throw of target creature, rather than lowering Save DC. Have to cap at 41 hours max or the Charm effect is permanent (except with Dispel Magic). Now uses duration of 1 hour per level (can't use PnP duration of 1 day per level due to game-engine limitations). Target gets +5 to save attempt if in combat (as per PnP). If Target fails an opposed Charisma check, it is Dominated instead of Charmed. This simulates the caster being able to convince the Target to do something it wouldn’t ordinarily do. (Retries are not allowed.)
-Charm Person- Reworked script so charm isn't permanent anymore. Now actually increases saving throw of target creature, rather than lowering Save DC. Have to cap at 41 hours max or the Charm effect is permanent (except with Dispel Magic). Now uses correct PnP duration of 1 hour per level. Target gets +5 to save attempt if in combat (as per PnP). If Target fails an opposed Charisma check, it is Dominated instead of Charmed. This simulates the caster being able to convince the Target to do something it wouldn’t ordinarily do. (Retries are not allowed.)
-Circle of Death- Wasn't properly capped at 20d4 as per PnP. Now it is. Changed radius in-script to PnP correct 40'. Changed Targeting UI to show correct PnP radius. Set nMax to 9 as creatures of 9 or more Hitdice can not be affected as per PnP.
-Cloudkill- Increased duration to 1 round / level. Changed school from Necromancy to Conjuration. Caster Level stored on AOE for proper Dispel Magic callback. Changed radius to correct size of 20' radius as per PnP. Added 20% Concealment to Melee attacks as per PnP. Added 50% Concealment to Ranged attacks (in-coming and out-going) to simulate the miss chance per PnP for targets further than 5 feet away. Assumes you would change to melee weapon if closer than 5.1 feet. This assumption isn't 100% accurate but something had to be done to simulate being further than 5 feet away.
-Cloudkill- Can't stack spell in the same area of effect anymore. Range changed from Long to Medium. No spell resistance. Moved metamagic and damage roll to inside of loop, otherwise one roll at the beginning of round was being used, rather than a new roll for every target. Immunity to poison by one target doesn't cancel spell for all other targets anymore. CON damage will now stack properly. Can't be dispelled while in the cloud.
-Cloud of Bewilderment- Saving throw MUST use the area of effect creator, otherwise saves aren't done correctly. On-enter script needed valid area of effect creator check. Will remove area of effect if caster is dead. On-heartbeat script needed spell resistance check AFTER checking to see if the target is already affected by Cloud of Bewilderment for more efficient use of script.
-Cloud of Bewilderment- Can't stack spell in the same area of effect anymore. Caster Level stored on AOE for proper Dispel Magic callback. Changed Targeting UI to custom setting of 10' spellcone. Decreased size down to 10'. Now takes into account ranks in spellcraft. Immunity to poison now works correctly.
-Cloud of Bewilderment- Will no longer cast spell so that it catches the caster in the AOE. Size was twice what it should have been (in-script). Now it's correct. Visual effect is now a custom vfx so it shows the correct size now.
-Color Spray- Matches PnP stats. Creatures 2 HD or less: The creature is unconscious, blinded, and stunned for 2d4 rounds, then blinded and stunned for 1d4 rounds, and then stunned for 1 round. Creatures with 3 or 4 HD: The creature is blinded and stunned for 1d4 rounds, then stunned for 1 round. Creatures with 5 or more HD: The creature is stunned for 1 round.
-Color Spray- Changed Spells.2da to not allow Maximize or Empower. Changed Targeting UI to 16 and size (in-script) to 15 feet. Removed ability (in-script) to Empower, Maximize, or Extend this spell. Immunity to MindSpells was causing automatic failure of save and Blindness being automatically applied because of this. This was fixed. Immunity to mindspells check was added. Immunity check, for Blindness, now takes into account Protection from Good/Evil. No longer initiates a spell resistance check on the caster.
-Combust- Initial damage changed to 1d8/level (max level=10). Changed secondary damage to equal PnP damage of 1d6 per round. Secondary save is set to Reflex = 15 as per PnP.
-Combust- Added in missing Melee Touch Attack roll. Now correctly calculates extra damage on a critical hit. Respects immunity to critical hits. Added sneak attack damage. Now takes into account Weapon Finesse. Now does extra damage if you have the (custom) feat Melee Spell Specialization.
-Cone of Cold- Changed range to personal as it should originate from the caster's hand as per PnP. Length of spell cone is now 60 feet as per PnP. No longer initiates a spell resistance check on the caster.
-Contagion- Changed Filth Fever ability damage from Intelligence to Dexterity. Changed Shakes ability damage from Strength to Dexterity. Changed Slimy Doom ability damage from Dexterity to Constitution. This was done by editing Disease.2da.
-Control Undead- There is no limit on how many undead you can control with this spell. However, there is a limit per casting (twice your caster level in hitdice).
-Control Undead- Changed duration to match that of PnP. 1 minute per level.
-Control Undead (not PM version)- Now is 15' radius AOE that only affects undead targets. Will only try to dominate enemy undead. Targeting UI changed to reflect new size. Can now target on the ground, not just on a creature.
-Creeping Doom- Complete script re-write. This now follows PnP. Auto-hit (no attack roll) for 2d6 damage (plus poison) while in the AOE as per PnP. DC 13 poison check for 1d4 Dexterity damage on both initial damage and secondary damage (1 minute later). Daze DC 13 Fortitude check in heartbeat script (nauseated as per PnP "distraction"). DC 20 spell failure check- if failed you can't cast spells. Both distraction and spell failure only last 1 round. Both checks are made every round while in the AOE. Can't stack spell anymore. Caster level stored on AOE for proper dispel magic callback. Incorporeal creatures can't be hurt by swarms as per PnP. Duration doesn't follow PnP as 1 min/level is waaaaay too long (at 20th level would last 10 game hours). Kept as 1 round/level.
-Creeping Doom- Improved the visual effect of the AoE. Using extended version now works correctly. Will correctly be dispelled now by Gust of Wind or Dispel Magic.
-Crushing Despair- Changed Range from Medium to Personal as per PnP. Changed size of cone to correct size of 9.144 meters to match PnP value (30 feet). Wasn't giving -2 penalty to skill checks as it should per the description. Linked all effects together, otherwise, Dispel Magic would not correctly remove all of the effects. Immunity to Mind Spells now works correctly. Now doesn't affect caster anymore. Immunity feedback message now takes into account Protection from Good/Evil.
-Cure Minor Wounds- Now only heals 1 hitpoint as per PnP.
-Curse of Impending Blades- Now has a spell resistance check. No longer stacks with itself or Mass Curse of Impending Blades. Can't be dispelled anymore (except by Greater Dispel Magic) as it's a curse (supernatural effect). Made it a supernatural effect like it's supposed to be.
-Darkness- Changed duration to be 10 game minutes/level (20 real seconds per level- 1/6 that of hour/level spells). 1 game hour is 2 real-time minutes. Changed duration to permanent (in on-enter script) as the effect should not wear off unless you leave the AOE or the AOE goes away. Either way will call the Darkness (on-exit) script, which will properly remove the effects. Changed range from Long to Touch as per PnP.
-Daze- Range set to short. Creatures of 4 HD or less can be affected. Not 5HD or less. Duration is 1 round not 2. These match PnP.
-Death Armor- Capped at 1d4 +10 as per Spell Compendium page 60. This brings it in-line with PnP.
-Death Knell- Correctly calculates extra damage on critical hit. Respects immunity to critical hits. Delinked Hitpoints so spell is not cancelled when losing bonus Hitpoints. Duration is 10 minutes per HD of target (10 minutes = 10 Turns). Removes previous effect only if new target fails save.
-Death Ward- Changed duration to match that of PnP. 1 minute per level.
-Deep Slumber- Changed Targeting UI and script to PnP correct 10' radius. Set script to 10HD max (not 10HD + 1d10) and duration to 1 min/level. Both are as per PnP. Range changed from Long to Short. Now affects creatures with up to 10HD. Now properly removes caster's invisibility when cast.
-Delayed Blast Fireball- Duration set to 5 rounds max. Changed Targeting UI to match 20' radius (in-script already as 20' radius). Fireball detonates automatically at the end of 5 rounds even if an enemy hasn't tripped it yet. Range changed from Medium to Long. Now uses my custom Spell Resistance check routine. This fixes the SR and Mantle problems that Obsidian's code has with AOEs that have a duration.
-Disintegrate- Updated for changes to how Mordenkainen's Sword now works. Now destroys my modified Mordenkainen's Sword. Now takes into account Ranged Spell Specialization. Now takes into account Point Blank Shot. Now kills trolls if they are reduced to 0hp or less. Now destroys Mordenkainen's Sword as per PnP. Range changed from Long to Medium. Added sneak attack damage. Now can be empowered. Uses ranged touch attack like it's supposed to (not melee touch attack). Correctly calculates extra damage on critical hit. Respects immunity to criticals.
-Dispel line of spells (Lesser Dispel, Dispel Magic, Greater Dispel)- Updated for changes to how Mordenkainen's Sword now works. AoE dispel now actually works with my PnP Dispel Logic or the default logic (Mordenkainen's Disjunction). Now can cast as three different versions. Single-target hostile, single-target friendly, and Area of Effect. Now automatically removes the AOE if you created it (as per PnP). This works on all AOE's (that you created) even if I haven't updated those AOE's yet to store their Caster Level for proper Dispel Magic callback.
-Dispel Magic (Lesser)- Can now actually use it to make properly working scrolls. Now can remove Mordenkainen's Sword as per PnP. Changed radius size form LARGE to HUGE. This makes it a 20' radius which matches PnP. Also, changed Targeting UI to match the new size. Now uses PnP version of dispel check for AOE spells. Defaults to Obsidian's clunky fudge of a dispel check for any persistent AOE's that aren't updated to take advantage of my new code.
-Dispel Magic- Can now actually use it to make properly working scrolls. Now can remove Mordenkainen's Sword as per PnP. Changed radius size form LARGE to HUGE. This makes it a 20' radius which matches PnP. Also, changed Targeting UI to match the new size. Now uses PnP version of dispel check for AOE spells. Defaults to Obsidian's clunky fudge of a dispel check for any persistent AOE's that aren't updated to take advantage of my new code.
-Dispel Magic (Greater)- Can now actually use it to make properly working scrolls. Default level of scrolls upped from level 7 to level 15. Now can remove Mordenkainen's Sword as per PnP. Now doesn't give curse removal message if target isn't cursed. Changed max caster level for dispel check to PnP correct +20. Now has a chance to dispel curses as per PnP. Changed radius size form LARGE to HUGE. This makes it a 20' radius which matches PnP. Also, changed Targeting UI to match the new size. Now uses PnP version of dispel check for AOE spells. Defaults to Obsidian's clunky fudge of a dispel check for any persistent AOE's that aren't updated to take advantage of my new code.
-Divine Favor- Now has a PnP correct max value of +6 (up from +3).
-Divine Power- Persistent Metamagic now actually works. Casting this a second time, on the same target, will no longer cause the BAB increase to disappear. Can be persisted if you have a Cleric with the Strength Domain. Now takes into account Epic Levels (up to 30th level). Sets BAB to that of a fighter of the same total character level. Extra Attacks per round (You end up with the same number of attacks per round as a Fighter). 
-Divine Wrath- Was calling wrong spell id in signal event. This is a true damage reduction effect and therefore Adamantine should not bypass it. Changed the DamageReduction effect to reflect this.
-Drown- Changed from Transmutation to Conjuration in Spells.2da as per the Spell Compendium page 74 and also the in-game description.
-Eldritch Doom- Now heals friendly undead when used with Utterdark Essence. Now only affects enemies, and always originates centered on-caster. Fixed targetting UI to show correct size radius (was too small). Changed range from Medium to Personal, as it's centered on-caster.
-Enervation- Duration now capped at 15 hours max (matches PnP). Added missing beam effect. This effect gets shown on a miss or a hit. Added sneak attack damage. Correctly calculates extra damage on critical hit. Respects immunity to critical hits.
-Evards Black Tentacles- Does a grapple check as per PnP. No paralysis. No fortitude save against paralysis. If Grappled: Roots target in place (can't use legs). Applies -4 penalty to attacks. 100% spell failure (can't cast spells while being grappled). Can't grapple a creature larger than Huge as per PnP description. Can't affect incorporeal creatures (shadows and such- must have physical presence to grapple them). No to hit roll since the PnP description states that this spell doesn't use a to hit roll during it's grapple check. ALL creatures in the area of effect have their movement speed reduced by 50%, even if they aren't being grappled, as per PnP description.
-Evard's Black Tentacles- Should be using EffectMovementSpeedDecrease(50) instead of EffectSlow. Now it is correct.
-Evard's Black Tentacles- Freedom of Movement now makes you immune to this spell. Changed radius size from 10' to 20' as per PnP. Changed TargetingUI (3rd column from end) from 7 to 2 to match 20' radius.
-Evard's Black Tentacles- Fixed visuals so tentacles don't disappear right after casting. Changed to PnP correct 1 grapple attempt per round, not 1d4. Caster Level stored on AOE for proper Dispel Magic callback. This is the first one that works this way (as per PnP rules). Can't stack spell in the same area of effect anymore. This is the first one that works this way.
-Expeditious retreat- Changed movement speed increase to an increase of 50% as this is what is listed for PnP (30 feet increase).  Quoted from PnP: "If you do nothing but move (that is, if you use both of your actions in a round to move your speed), you can move double your speed". (That would be 60 feet total). So 30 feet would be a 50% increase. Also, changed duration to 1 minute per level as per PnP.
-Extract Water Elemental- Being immune to Death Magic shouldn't block this spell. Only non-living creatures (Undead and Constructs) are immune.
-Fear- Range changed from Medium to Touch. On successful will save creature is still shaken (see Cause Fear) for 1 round as per PnP. Also added in -2 penalties when save is failed, as the shaken effect applies whether or not the save is successful as per PnP.
-Fear- Changed area of effect from a circle to a 30' cone as per PnP. Fixed "Shaken" penalties as follows: Changed Damage decrease to Skill decrease (should never have been a damage penalty but rather a skill penalty). Also, changed saving throw decrease from will saves versus mind spells to all saves versus all types of spells as per PnP.
-Feeblemind- Changed school to Enchantment. Changed Spells.2da to not allow Maximize, Empower, or Extend. Lowers target's stats to 1 just like PnP. Was set to 3 by mistake. Also, made it a supernatural effect so Dispel Magic and/or resting can't remove it. Affected creature unable to cast spells as per PnP. Added -4 penalty to will save for Arcane caster classes as per PnP. Made it permanent like PnP. Lowers target's stats to 3 just like PnP. If permanent you can only remove it with a heal spell.
-Fire Shield- Correctly capped at 1d6 + 15 max as per WoTC website.
-Firestorm- Size scales with caster level (up to level 20). AoE size is 200 square feet per caster level. Now affects any creature in the AoE as per PnP.
-Firestorm- Now properly capped at 20d6 damage. Now only does one save, instead of incorrectly doing two saves. Save type is versus fire. There is no divine damage as per PnP. Range changed from Long to Medium as per PnP.
-Flesh to Stone- Petrification can't be removed by resting anymore. Dispel Magic can't remove it anyway, so I made it a Supernatural effect. Can't affect Constructs, Undead, or Incorporeal creatures as per PnP rules. Both Undead and Constructs are immune to any effect that requires a fortitude save, unless the effect also works on objects or is harmless. Flesh to Stone fails this requirement because in it's description it states that it affects one creature (not one object). Incorporeal creatures have no flesh. Sorry, no flesh no worky.
-Freezing Sphere- New spell. Redid scroll so it actually works again. Can use scribe scroll to create copies to give to other spell-casters. Scroll is NW_IT_SPARSCR6111.
-Frenzy- Dispel Magic won't cancel effects anymore. Only 2 hp/round of damage instead of the 6 hp/round being used by NWN2. Also, added the missing extra attack per round that should be included. De-linked extra attack with the other extraordinary effects, so it shouldn't stack the extra attack with Haste anymore since the extra attack isn't considered extraordinary. It's considered a spell-like effect and therefore the game engine won't stack two of the same spell-like effects.
-Ghoul Touch- Linked effects (on original target) so Dispel Magic removes all effects properly. Attack penalty was never linked to the other effects. Saving Throw decrease was linked twice, not once. GetAreaofEffectCreator() must be passed into saving throw, otherwise invalid saves can occur. Immunity to poison prevents the stench affecting you as per PnP.
-Grease- (On Heartbeat) Added check for immunity to knockdown. If immune to knockdown, creature is immobilized using CutSceneImmobilize (on a failed save). This simulates falling, as being immune to knockdown doesn't make you immune to falling down.
-Grease- Changed size from 20' radius circle to 10' by 10' square as per PnP. Changed TargetingUI to reflect the change in shape and size. Range changed from L to S.
-Greater Invisibility- Changed the invisibility type to INVISIBILITY_TYPE_IMPROVED. This allows the affected creature to remain invisible even after attacking, just like PnP. Only creatures that can see invisible creatures or succeed at a listen check can target the affected creature.
-Greater Magic Fang- Now works on 2 of the 3 creature's weapons. This isn't PnP "perfect", but it takes care of the problem with creature attacks not always following their correct progression. Now works with Druid's Elemental Shape form (considered Outsider not Elemental) and Dragon Shape form. Added in racial type Elemental as one of the creature types that can be affected by this spell. Range changed from Touch to Short. Duration is now 1 hour/level and enhancement bonus is +1 per 4 caster levels. Will properly add enhancement bonus to natural weapons of target creature. By not adding attack and damage bonus to the creature's natural weapons, but instead adding enhancement bonuses, the effect will be removed properly. This prevents Druids from keeping the bonus (attack and damage bonus) after cancelling Wildshape. Now includes Kaedrin's check for Plant and Magical Beast.
-Greater Magic Weapon- Enhancement bonuses are allowed on Ranged Weapons, so this spell works on them too. Monks can take advantage of this spell (if wearing Gauntlets), as well as anyone wearing Gauntlets.
-Greater Restoration- Script updated to remove Insanity, Fatigue, and Exhaustion as per PnP. In-game description updated to properly state what effects the spell removes. Doesn't heal Hitpoints anymore as per PnP. Won't remove "Reduce" spell effects. Removes Solipsism effect.
-Gust of Wind- Changed from 40' diameter AOE to line shaped effect (have to use SpellCone instead). Changed from RADIUS_SIZED_HUGE to 18.288 meters (60 feet) as per PnP. Medium sized creatures (and smaller) can't move towards the caster for 1 round (uses CutsceneImmobilize to simulate this effect). Small or lesser sized creatures are knocked prone (EffectKnockdown) for 1 round. This is as close to PnP as I can get for now. All creatures in the area of effect suffer -4 to ranged attacks and listen checks for 1 round (duration of Gust of Wind) as per PnP.
-Gust of Wind- Dispels only the following AOE objects: Acid Fog, Choking Powder, Cloud of Bewilderment, Cloudkill, Creeping Doom, GhoulTouch, Incendiary Cloud, Mindfog, Stinking Cloud, StoneHold, and Tenacious Plague.
-Gust of Wind- Now actually removes Fog Of Bewilderment. Now actually removes Choking Powder. Now working on Creeping Doom and Tenacious Plague.
-Harm- Added sneak attack damage. Spell now properly targets hostile creatures. Does critical hit for extra damage. Respects immunity to criticals. No attack roll versus undead, since it's assumed you are trying to heal them and they are immune to criticals. Can't lower target's hitpoints to less than 1 as per PnP.
-Heal- Can't reduce undead's hitpoints to less than one, per PnP. Now removes Insanity, Fatigue, and Exhaustion as per PnP. Heal versus undead now uses a touch attack, like it should. Now removes effects, as per PnP.
-Heal- Won't remove the effects of Enlarge Person, Duergar Enlarge Racial ability, Iron Body, or Stone Body. Won't remove "Reduce" spell effects. Removes Solipsism effect.
-Horrid Wilting- Changed to Selective Hostile which means it is Enemy-only. According to WoTC it is not a 30' radius spread (which would affect everything), but it targets living creatures that are within 60' of one another. Quoted from WoTC: "This spell evaporates moisture from the body of each subject living creature". This implies that you pick the targets as long as they are within 60' of one another. This acts like a 30' radius for the game engine.
-Horrid Wilting- Changed Target UI to reflect proper 60' area. Changed to a range of Long as per PnP. Water Elementals take d8 damage instead of d6 as per PnP.
-Icelance- New spell. Redid scroll so it actually works again. Can use scribe scroll to create copies to give to other spell-casters. Scroll is NW_IT_SPARSCR3112.
-Implosion- Changed to be closer to PnP. Max of 4 targets can be affected. Only one creature per round can be affected. +3 to save DC was removed as this isn't true for PnP. Incorporeal creatures, such as shadows, can't be affected by this spell (and don't count towards cap of 4). Changed to SelectiveHostile- in PnP you pick your targets so you wouldn't kill your allies. Immunity to Death does not protect you- as per PnP this has a Destruction descriptor, not Necromancy descriptor (Death Magic). It causes the creature to collapse in on itself (like a mini-blackhole), killing it. Trolls can be killed by this spell as it does fire damage to them instead (EffectDeath doesn't kill trolls- only fire or acid does). Those who are immune to death suffer Magic Damage equal to their current hitpoints +30 (this assures that DR doesn't lower the damage suffered to a non-lethal level such as having DR 30/Magic).
-Improved Invisibility (Assassin)- Now takes into account assassin levels for duration. Same as Greater Invisibility. Also lowered duration to 1 round/level to bring it in-line with Greater Invisibility.
-Incendiary Cloud- Changed school from Evocation to Conjuration. Can't stack spell in the same area of effect anymore. Caster Level stored on AOE for proper Dispel Magic callback. Changed radius to correct size of 20' radius as per PnP. Added 20% Concealment to Melee attacks as per PnP. Added 50% Concealment to Ranged attacks (in-coming and out-going) to simulate the miss chance per PnP for targets further than 5 feet away. Assumes you would change to melee weapon if closer than 5.1 feet. This assumption isn't 100% accurate but something had to be done to simulate being further than 5 feet away. Range changed from Long to Medium. No spell resistance.
-Inspire Frenzy- Added the missing extra attack per round that should be included. Removed the Greater Frenzy check as the spell only applies +6 strength to your allies (never +10 so why check for it?). Lowered the damage per round to equal Frenzy's 2 hp/round.
-Invocation: Beshadowed Blast- Now follows PnP: 50% movement speed decrease, -4 to search checks, and automatically fail spot checks (simulated by giving a -50 penalty to spot skill).
-Invocation: Charm- Reworked script so charm isn't permanent anymore. Now actually increases saving throw of target creature, rather than lowering Save DC. Have to cap duration at 41 hours max or the Charm effect is permanent (except with Dispel Magic).
-Invocation: Chilling Tentacles- Freedom of Movement now makes you immune to the physical part of this spell. Changed to PnP correct 1 grapple attempt per round, not 1d4. Can't stack spell from same caster anymore. Now does a grapple check as per PnP. No paralysis. No fortitude save against paralysis. Uses Cutscene Immobilize to root the target in place to simulate being grappled. Applies -4 penalty to attacks. 100% spell failure (can't cast spells while being grappled). Can't grapple a creature larger than Huge as per PnP description. Can't affect incorporeal creatures (shadows and such- must have physical presence to grapple them). ALL creatures in the area of effect have their movement speed reduced by 50%, even if they aren't being grappled, as per PnP description.
-Invocation: Curse of Despair- Afflicted creature must save or suffer a -4 penalty on to-hit rolls, saves, and skill checks. This is a supernatural effect and follows the PnP description. Saves caster level on target so Greater Dispel (can remove curses) works correctly. Even if target makes it's save, it suffers -1 to attack rolls for 60 seconds.
-Invocation: Devour Magic- Changed the max caster level for dispel check to PnP correct +20. Won't remove it's own temporary hitpoints anymore.
-Invocation: Frightful Blast- Frightful blast now works on creatures of any HitDice, as per PnP. Now will properly have all effects removed on a dispel. Fixed it so that fear effect is not applied, just the shaken penalties, as per PnP.
-Invocation: Hellrime Blast- Duration is now PnP correct 10 minutes.
-Invocation: Retributive Invisibility- Now lasts for 1 round per level as per PnP. Retributive effects do not damage the caster on Hardcore difficulty. Stun effect is corrected to last only one round now instead of three. All effects will be removed on a properly failed Dispel Magic check. 
-Invocation: UtterDark Blast- Now actually level-drains non-undead again. Wasn't working properly in version 3.12. Undead no longer have to make a fortitude save when Utterdark Blast is used against them, as it can't level-drain them anyway. Utterdark Blast now heals Undead like it should. Fixed to allow stacking of negative levels, and to limit the duration to 1 hour (both as per PnP).
-Invocation: Wall of Perilous Flame- Changed duration to match that of PnP. 1 round/level. Changed damage to match PnP. 2d6 +1/caster level.
-Lay on Hands- Now works against Undead by creating a second Lay on Hands feat that is linked to the original Lay on Hands feat. Paladins (and Divine Champions) will automatically acquire this feat on their next level-up as long as they are at least 2nd level (1st level for Divine Champion).
-Lay on Hands (hostile)- Added in check for Hospitaler levels. Added in Weapon Finesse check and Melee Spell Specialization check.
-Lesser Restoration- Now removes Fatigue as per PnP, and won't remove effects of Reduce spells.
-Maddening Scream- New Spell. Redid scroll so it actually works again. Can use scribe scroll to create copies to give to other spell-casters. Scroll is NW_IT_SPARSCR8111. The subject cannot keep him or herself from behaving as though completely mad. This spell makes it impossible for the victim to do anything other than race about caterwauling. The effect worsens the Armor Class of the creature by 4, makes Reflex saving throws impossible except on a roll of 20, and makes it impossible to use a shield.
-Magic Fang- Now includes Kaedrin's check for Plant and Magical Beast.
-Magic Missle- Changed from burst to accelerating in Spells.2da to speed up path of missles. Lowered Casting time from 2.5 seconds to 1 second so the missles hit their target before next week.
-Magic Missle- Range set to Medium as per PnP.
-Mass Cure Light Wounds- Now takes into account Augmented Healing Feat. Uses will save now instead of incorrect fortitude save. Capped max heal bonus to +25 as per PnP. Was using wrong variable during metmagic mods. Won't automatically hurt friendly undead anymore, only if they are in the area of effect.
-Mass Curse of Impending Blades- Now has a spell resistance check. No longer stacks with itself or Curse of Impending Blades. Can't be dispelled anymore (except by Greater Dispel Magic) as it's a curse (supernatural effect). Made it a supernatural effect like it's supposed to be. Changed to correct size of 20' radius (6.069 meters). Now only affects enemies, as it should (according to the Spell Compendium).
-Mass Heal- In-game description updated. Max number of hitpoints of damage done to an undead creature is now properly set to 250 per target, however, it can't reduce the undead's hitpoints to less than one as per PnP. Now removes Insanity, Fatigue, and Exhaustion as per PnP. Won't remove "Reduce" spell effects. Removes Solipsism effect. Now removes wounding effect. Per PnP description, Mass Heal can heal a maximum of 250 hitpoints. Won't automatically hurt friendly undead anymore, only if they are in the area of effect. Won't remove the effects of Enlarge Person, Duergar Enlarge Racial ability, Iron Body, or Stone Body.
-Mass Inflict Light Wounds- Range changed from Medium to Short.
-Melf's Acid Arrow- Now takes into account Ranged Spell Specialization. Now takes into account Point Blank Shot. Added sneak attack damage. No spell resistance. Does 2d4 damage on initial hit and each round. Correctly calculates extra damage on critical hit. Respects immunity to critical hits. Only does critical on initial round.
-Melf's Acid Arrow- Sneak attack function now takes into account concealment. Sneak attack function now takes into account being pinned (simulated by Cutscene Immobilize). Cutscene Immobilize from the spell "Grease" doesn't count towards being pinned. Fixed stacking issues. You can, as it should be able to, stack this spell now as it keeps track of each arrow's duration individually. A miss doesn't cancel all other arrow's effects anymore.
-Meteor Swarm (Creature)- Does double damage on a critical hit (if not immune to criticals). Added sneak attack damage (respects immunity to critical hits). Added PointBlankShot and Ranged Spell Specialization check. Seriously sped up how long it takes for all of the effects to take affect.
-Meteor Swarm (Location)- Now only spawns 4 meteor projectiles as per PnP. Everyone in the AoE is subject to 24d6 fire damage.
-Mind Fog- Now takes into account ranks in spellcraft during save. Immunity to Mind Spells now works correctly. Can't stack spell in the same area of effect anymore. Caster Level stored on AOE for proper Dispel Magic callback. Now applies -10 penalty to wisdom-related skills as per PnP. Changed TargetingUI to show correct 20' radius. Changed School from Illusion to Enchantment. Changed Range from Long to Medium. Immunity feedback message now takes into account Protection from Good/Evil.
-Mirror Image- Maximized corrected to 8 images, not 4. Dispel Magic now removes all effects properly. Corrected to use AC=(10+dexterity modifier) for the created images like it's supposed to. Also, removed the level 15 cap as this is not per PnP.
-Mordenkainen's Disjunction- AoE dispel now actually works with my PnP Dispel Logic or the default logic (Mordenkainen's Disjunction). Now can cast as three different versions. Single-target hostile, single-target friendly, and Area of Effect.
-Mordenkainen's Sword- Rescripted to remove several exploits. Added my modified creature blueprint to SpellsPnP folder. Now has one attack per round as per PnP. Has attack bonus equal to (caster level + caster's ability modifier +3 enhancement) as per PnP. It can be destroyed by Disintegrate. It has complete immunity to physical damage and elemental damage as per PnP. It has an AC of 13 (10 base and +3 Deflection). Saves casterlevel for proper Dispel Magic callback.
-Mordenkainen's Sword- Changed School from Transmutation to Evocation as per PnP. Fixed script so only the sword can receive the bonuses. Sword now does 4d6 +3 force (magical) damage on a hit. Removed +3 Enhancment bonus from equipped sword, so, had to increase AB by +3. Each caster, in the party, can now have one instance of this spell active at the same time. Used to be only one sword was allowed for the entire party. Sword can't be killed by using Divine Might anymore.
-Palemaster: Bone Armor Spell Failure Reduction (feats gained at 4th and 8th level)- Can no longer exceed the innate Spell failure of the armor. In other words, if wearing leather armor (10% spell failure), an 8th level PM will only receive a 10% reduction in Arcane Spell failure (not 20%). This will set the armor's spell failure to 0 (not -10% like it used to do).
-Palemaster: Control Undead feat- Updated script to take into account the feat Id is now 3403 and not 2861. So now it actually works again. Range for Palemaster feat usage is touch not short. Uses cutscene dominated for Palemaster so there is no way for an undead creature to resist it.
-Palemaster: Deathless Master Touch- Added sneak attack damage. Added check for weapon finesse feat to modify attack roll. Added true death touch (10th level Palemaster) and creation of caster controlled Zombie if target is killed. Added Weakening touch (7th level), Degenerative touch (8th level), and Destructive touch (9th level). Increased save DC to that of PnP. Decreased duration to match PnP.
-Palemaster: Undead Graft- Added sneak attack damage. Added check for weapon finesse feat to modify attack roll. Added true death touch (10th level Palemaster) and creation of caster controlled Zombie if target is killed. Added Weakening touch (7th level), Degenerative touch (8th level), and Destructive touch (9th level). Increased save DC to that of PnP. Decreased duration to match PnP.
-Poison- Changed to work as per PnP. Added sneak attack damage.
-Power Word Kill- Changed school to Enchantment.
-Power Word Stun- Changed school to Enchantment.
-Prismatic Spray- Change targeting UI to custom setting (60'- same as cone of cold). Changed range from Short to Personal. Changed to be more like PnP version. Made confusion permanent effect so it acts like insanity effect which is permanent. Can only be removed with a Heal Spell or Greater Restoration spell. Resting will not remove the effect. Removed Paralysis effect as it doesn't exist in PnP. Changed size of cone to equal 60 feet not the 11 meters it was using. Changed duration of blindness to 2d4 rounds as per PnP. Changed poison effect to take into account immunity to poison. If immune no effect. If not immune, but you make your save, you are still affected with a Constitution decrease of 1d6 just like PnP.
-Prismatic Spray- Properly applied roll to see if 2 effects are done (1 in 8 chance). Removed double save for stone effect. Removed double resistance check for stone effect. Removed redefining of target in stone effect. No longer initiates a spell resistance check on the caster.
-Ray of Enfeeblement- Can't drop target's strength to less than 1 as per PnP. Now lasts 1 minute per level. Won't stack anymore.
-Ray of Frost- Changed School from Conjuration to Evocation as per PnP. Now takes into account Ranged Spell Specialization. Now takes into account Point Blank Shot. Added sneak attack damage. Added critical hit for extra damage. Respects immunity to critical hits.
-Restoration- Now removes Fatigue and Exhaustion as per PnP, and won't remove effects of Reduce spells.
-Righteous Might- Now stacks with Bull's Strength or Mass Bull's Strength. Gives correct 1 round/level duration. You gain a +4 size bonus to Strength and a +2 size bonus to Constitution. You gain a +2 enhancement bonus to your natural armor. You gain damage reduction 3/evil (if you normally channel positive energy) or damage reduction 3/good (if you normally channel negative energy). At 12th level this damage reduction becomes 6/evil or 6/good, and at 15th level it becomes 9/evil or 9/good (the maximum). Your size modifier for AC and attacks changes as appropriate to your new size category (-1 Dodge bonus to AC, -1 to Attacks, and +3 to damage rolls).
-Scare- Range changed from Short to Medium. Now affects multiple targets like it's supposed to. On successful will save, if creature has less than 6HD, it is still shaken (see Cause Fear) for 1 round as per PnP.
-Scare- Fixed "Shaken" penalties as follows: Changed Damage decrease to Skill decrease (should never have been a damage penalty but rather a skill penalty). Also, changed saving throw decrease from will saves versus mind spells to all saves versus all types of spells as per PnP.
-Shroud Of Flame- Won't stack anymore. Metamagic variable properly stored for future callbacks so casting another metamagically enhanced spell will not apply new metamagic to this spell. Will dispel delayed effects properly. Now taking into account Improved Evasion on failed reflex save.
-Shroud Of Flame- Range changed from Short to Medium. Removed taking into account Improved Evasion on failed reflex save as this was wrong. Changed spell school from Transmutation to Evocation in Spells.2da as per WoTC.
-Stinking Cloud- Can't stack spell in the same area of effect anymore. Caster Level stored on AOE for proper Dispel Magic callback. Changed radius to correct size of 20' radius as per PnP. Duration properly set to 1d4+1 rounds (was 2). Added 20% Concealment to Melee attacks as per PnP. Added 50% Concealment to Ranged attacks (in-coming and out-going) to simulate the miss chance per PnP for targets further than 5 feet away. Assumes you would change to melee weapon if closer than 5.1 feet. This assumption isn't 100% accurate but something had to be done to simulate being further than 5 feet away. No spell resistance.
-Tensor's Transformation- Now takes into account Epic Levels (up to 30th level). No actual polymorph effect. Sets BAB to that of a fighter of the same total character level. Extra Attacks per round (You end up with the same number of attacks per round as a Fighter). +4 bonus to Natural AC. +4 bonuses to STR,DEX and CON. Can't cast spells while under the effects of the spell. +5 bonus on Fortitude Saves. Proficient with Simple weapons. Proficient with Martial weapons.
-Timestop- Now is enabled. Now lasts for correct 1d4 +1 rounds instead of 9 seconds fixed duration. Added some code to prevent damage and/or attacking targets while time is stopped. As per PnP. If you want to waste spells or melee attacks, go ahead and try to hurt your time-stopped opponents. You can cast AoE spells with a duration (that will only damage opponents after the time stop ends) at your opponents. Direct target spells, instantaneous AoE spells (ex: Fireball), and melee attacks will fail. You can buff yourself while time is stopped.
-Timestop- No longer causes a server-wide timestop effect. Now is localized to a 70 meter radius effect (was 36.576).
-Wail of the Banshee- Changed to PnP correct 40 foot radius spread. Targeting UI in Spells.2da was changed to show correct radius. Fixed issue where target nearest to spell target location would get counted twice. Shortened the time that the spell takes to affect the targets by about 2.5 seconds. Now properly takes into account you and your allies (if in the area you/they will not count towards the total number that can be affected).
-Wall of Fire- Caster Level stored on AOE for proper Dispel Magic callback. Now does proper Spell Resistance and Mantle check. Now correctly takes into account Spell Penetration feats when determining SR check. Can't stack spell within 5 meters of center-point of wall anymore.
-Wall of Fire- Lasts 1 round/level as per PnP. Removed saving throw check as there is none per PnP. Redid damage calculation as damage is 2d6 +casterlevel(max casterlevel is 20). It was being capped at max damage=20.
-Warpriest Battle Tide- Range changed from Personal to Short. Changed Area of Effect to a 15' radius. Changed TargetingUI to reflect 15' radius. Linked haste with Area of effect so they are both dispelled properly. Can't be stacked anymore.
-Warpriest Mass Cure Light Wounds- Now takes into account Augmented Healing Feat. Uses will save now instead of incorrect fortitude save. Capped max heal bonus to +25 as per PnP. Was using wrong variable during metmagic mods. Won't automatically hurt friendly undead anymore, only if they are in the area of effect.
-Warpriest Mass Heal- In-game description updated. Max number of hitpoints of damage done to an undead creature is now properly set to 250 per target, however, it can't reduce the undead's hitpoints to less than one as per PnP. Now removes Insanity, Fatigue, and Exhaustion as per PnP. Won't remove "Reduce" spell effects. Removes Solipsism effect. Now removes wounding effect. Per PnP description, Mass Heal can heal a maximum of 250 hitpoints. Won't automatically hurt friendly undead anymore, only if they are in the area of effect. Won't remove the effects of Enlarge Person, Duergar Enlarge Racial ability, Iron Body, or Stone Body.
-Web- No spell resistance. Can't stack spell anymore. Caster Level stored on AOE for proper Dispel Magic callback. Increased duration to 1 round per level.
-Weird- Changed Targeting UI and size in-script to PnP correct 30' diameter. Added both stun effect for 1 round and Strength decrease (but for only 20 rounds since it's temporary) on successful fortitude save as per PnP. Immunity check now takes into account Protection from Good/Evil.